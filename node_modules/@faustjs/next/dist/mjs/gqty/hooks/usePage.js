import { PageIdType } from '@faustjs/core/client';
import { useRouter } from 'next/router';
import defaults from 'lodash/defaults';
import isString from 'lodash/isString';
import { hasPageId, hasPageUri } from '../../utils';
export function create(useQuery) {
    return (args) => {
        const { query } = useRouter();
        const { page } = useQuery();
        let params = defaults({}, args);
        if (hasPageId(query)) {
            params = {
                id: query.pageId,
                idType: PageIdType.ID,
                ...params,
            };
        }
        if (hasPageUri(query)) {
            params = {
                id: query.pageUri.join('/'),
                idType: PageIdType.URI,
                ...params,
            };
        }
        if (!isString(params.id)) {
            throw new Error('Invalid parameters for usePage, you must send in an id or specify known URL params in your config');
        }
        return page(params);
    };
}
